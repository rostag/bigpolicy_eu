<form>
  <mat-card class="project-edit-card">
    <mat-card-content>
      <mat-card-title fxLayout="row" fxLayoutAlign="space-between stretch" fxLayout.xs="column">
        <div class="title">
          <span *ngIf="!isUpdateMode">Створити проект</span>
          <span *ngIf="isUpdateMode">Редагувати проект</span>
        </div>
        <!-- FIXME re-enable after fixing the:
         main.5e9c440a7af411b7e506.js:1 ERROR Error: Uncaught (in promise): TypeError: Cannot read property 'databaseURL' of null
TypeError: Cannot read property 'databaseURL' of null
    at t.databaseFromApp (4.df99a6774f8e47984022.js:1)
    at Object.n.INTERNAL.registerService.Reference [as database] (4.df99a6774f8e47984022.js:1)
    at t._getService (4.df99a6774f8e47984022.js:1)

         app-uploader folder="bp-files/projects/{{project._id || 'tmp_project_id'}}/images" listFiles="no"
                      buttonType="regular" buttonLabel="Додати зображення"
                      (uploadedFileUrlChange)="project.onImageUrlChange($event)"></app-uploader -->

      </mat-card-title>

      <app-image *ngIf="project.imageUrl" [src]="project.imageUrl"></app-image>

      <small>Проект</small>

      <mat-form-field>
        <input style="width: 100%;" matInput required
               placeholder="Назва проекту"
               [(ngModel)]="project.title" characterCounter
               [ngModelOptions]="{standalone: true}">
      </mat-form-field>

      <mat-form-field>
        <textarea matInput matTextareaAutosize required class="bp-textarea" rows="4" maxLength="1000"
                  [(ngModel)]="project.description" placeholder="Опиши свій проект чи захід:"
                  [ngModelOptions]="{standalone: true}">
        </textarea>
      </mat-form-field>

      <mat-form-field>
        <input matInput [(ngModel)]="project.videoUrl" placeholder="Відео до проекту:"
               [ngModelOptions]="{standalone: true}">
      </mat-form-field>

      <div class="cost-and-dates" fxLayoutGap="3%" fxLayout="row" fxLayoutAlign="space-between stretch"
           fxLayout.xs="column" fxLayout.sm="column">
        <mat-form-field class="cost" fxFlex.xs="100%">
          <div matPrefix>
            <mat-icon>monetization_on</mat-icon>
            Бюджет:&nbsp;
          </div>
          <input matInput required type="number" [(ngModel)]="project.cost" [ngModelOptions]="{standalone: true}"
                 value="1">
          <div matSuffix>UAH</div>
        </mat-form-field>

        <mat-form-field fxFlex.xs="100%">
          <div matPrefix>
            <mat-icon>date_range</mat-icon>
            Початок:&nbsp;
          </div>
          <input matInput type="date" [(ngModel)]="project.dateStarted" hintLabel="Коли проект починається?"
                 value="Вкажи дату початку проекту, будь ласка" [ngModelOptions]="{standalone: true}">
        </mat-form-field>

        <mat-form-field fxFlex.xs="100%">
          <div matPrefix>
            <mat-icon>date_range</mat-icon>
            Завершення:&nbsp;
          </div>
          <input matInput type="date" [(ngModel)]="project.dateEnded" hintLabel="Коли закінчується проект?"
                 value="Дата завершення проекту" [ngModelOptions]="{standalone: true}">
        </mat-form-field>
      </div>

      <!-- Project Tasks -->
      <app-task-list title="Заходи проекту" [project]="project" *ngIf="showTasks"></app-task-list>
      <!-- Working, just disabled: <app-task-list title="Закороткий опис" [project]="project" *ngIf="showTasks" [pageSize]="3" dbQuery='{ "$where": "this.description.length < 3" }'></app-task-list> -->
      <!-- /Project Tasks -->

    </mat-card-content>

    <mat-toolbar class="add-toolbar" color="#fff">
      <!-- MOVE TO OTHER LEADER -->
      <div *ngIf="userService.isAdmin && isUpdateMode">
        <button *ngIf="!leadersToMoveProjectTo" mat-button (click)="requestLeadersToSelectFrom()">Змінити лідера
        </button>
        <form *ngIf="leadersToMoveProjectTo">
          <mat-select placeholder="Select new leader" (change)="moveProjectToOtherLeader($event)" name="leader">
            <mat-option *ngFor="let leader of leadersToMoveProjectTo" [value]="leader">
              {{leader.name}} {{leader.surName}}
              <span *ngIf="userService.isOwner(leader)" class="icon-me">я</span>
            </mat-option>
          </mat-select>
        </form>
      </div>

      <span class="add-fill-remaining"></span>

      <button mat-button (click)="cancelEditing()" color="primary">
        Відмінити
      </button>
      <button type="submit" mat-raised-button (click)="saveProject()" color="primary">
        <span *ngIf="!isUpdateMode">Додати</span>
        <span *ngIf="isUpdateMode">Зберегти</span>
        <span>проект</span>
      </button>
    </mat-toolbar>

  </mat-card>
</form>
